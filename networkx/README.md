# EEG CCorr → NetworkX Graphs

A lightweight and adaptable Python 3.9+ utility for converting hyperscanning EEG/MEG connectivity matrices—stored in MATLAB `.mat` format—into analysis-ready NetworkX graph objects. 
While the current implementation was developed using data from the *Duorhythm* project, the tool is general-purpose and can be easily adapted to other inter-brain datasets with similar structure.

---

## Repository Structure

eeg-ccorr-to-networkx/
├─ src/
│  └─ build_graphs.py          ← main CLI script (argparse + main())
├─ examples/
│  └─ README.md                ← explains how to run on the toy file
├─ sample_data/
│  └─ CCORR_00.mat             ← 1 epoch × 1 band dummy (anonymised)
├─ .gitignore
├─ LICENSE                     ← MIT by default
├─ requirements.txt
└─ README.md                   ← project front page

---

## Input Format

The script expects `.mat` files of the form `CCORR_<dyad>.mat` generated by the *Duorhythm* pipeline. Each file contains three matrices:

CCORR_AA : 8 × N × 128 × 128
CCORR_SA : 8 × N × 128 × 128
CCORR_F  : 8 × N × 128 × 128

- 8 canonical EEG bands (Delta to Gamma-High)
- N epochs per condition (e.g., 20 epochs × 3 s)
- Channels 0–63 = Participant 1
- Channels 64–127 = Participant 2

---

## Output

The script outputs a pickled dictionary structured as:

graphs[dyad_id][frequency_band][condition] → networkx.Graph

Per dyad, the following elements are generated:

- Full 64 × 64 weighted undirected graphs
- 20-node ROI subgraphs (RF, RT, LF, RP clusters)
- A surrogate null graph averaged across bands
- Behavioral vectors (MARP / SDRP), if provided

---

## Installation

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

The only runtime dependencies are NumPy, SciPy, and NetworkX.

⸻

Quick Start

Convert a full dataset:

python -m src.build_graphs \
    --input     /Volumes/T7/duorhythm/exp/ccorr_adj \
    --behaviour /Volumes/T7/duorhythm/exp/relativephasemeasures/relativephasemeasures.mat \
    --output    ~/Downloads/graphs_networkx_plus.pkl

Try the example toy dataset:

python -m src.build_graphs \
    --input     sample_data \
    --output    sample_graphs.pkl \
    --dyads     00


⸻

Command-Line Options

Flag	Default	Description
--input	required	Folder containing CCORR_*.mat files
--behaviour	(none)	Optional path to relativephasemeasures.mat
--output	graphs_networkx_plus.pkl	Destination for output pickle
--dyads	all	Dyad selection: comma-separated list or range
--roi-only	false	Skip full graphs; keep ROI graphs only
--overwrite	false	Overwrite existing output file

To see the full list of options, run:

python -m src.build_graphs -h


⸻

ROI Subgraphs

ROI graphs retain only the following 20 electrodes (based on Chapter 3 of Loh, 2025):
	•	RF: 30, 31, 32, 60, 62
	•	RT: 20, 22, 21, 26, 55
	•	LF: 1, 3, 4, 34, 37
	•	RP: 19, 23, 49, 50, 52

⸻

Example Miniature Data

Included is a dummy CCORR_00.mat file with random values (8 × 1 × 128 × 128) for testing.

To run:

python -m src.build_graphs --input sample_data --output toy.pkl --dyads 00

Expected output:

Saved 1 dyads → toy.pkl
